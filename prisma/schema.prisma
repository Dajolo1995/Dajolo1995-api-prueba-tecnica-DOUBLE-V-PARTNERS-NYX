generator client {
    provider     = "prisma-client"
    output       = "../src/generated/prisma"
    moduleFormat = "cjs"
}

datasource db {
    provider = "postgresql"
}

enum DebtStatus {
    PENDING
    PAID
}

model User {
    id        String   @id @default(uuid())
    email     String   @unique
    password  String
    nickname  String   @unique
    name      String
    lastName  String
    phone     String
    code      String?
    isActive  Boolean  @default(false)
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    debtsCreated     Debt[]            @relation("DebtsCreated")
    debtParticipants DebtParticipant[]

    @@map("users")
}

model Debt {
    id          String  @id @default(uuid())
    description String
    totalAmount Decimal @db.Decimal(12, 2)

    createdById String
    createdBy   User   @relation("DebtsCreated", fields: [createdById], references: [id])

    status DebtStatus @default(PENDING)

    participants DebtParticipant[]

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@map("debts")
}

model DebtParticipant {
    id String @id @default(uuid())

    userId String
    user   User   @relation(fields: [userId], references: [id])

    debtId String
    debt   Debt   @relation(fields: [debtId], references: [id])

    amount Decimal    @db.Decimal(12, 2)
    status DebtStatus @default(PENDING)
    paidAt DateTime?

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@unique([userId, debtId])
    @@index([userId])
    @@index([debtId])
    @@map("debt_participants")
}
